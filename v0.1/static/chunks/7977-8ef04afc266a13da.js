(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7977],{55914:function(e,n,t){"use strict";t.r(n);var s=t(16480),r=t.n(s),c=t(2265),a=t(12865),i=t(57437);let l=c.forwardRef((e,n)=>{let{bsPrefix:t,className:s,as:c="div",...l}=e,d=(0,a.vE)(t,"row"),o=(0,a.pi)(),h=(0,a.zG)(),u="".concat(d,"-cols"),x=[];return o.forEach(e=>{let n;let t=l[e];delete l[e],null!=t&&"object"==typeof t?{cols:n}=t:n=t,null!=n&&x.push("".concat(u).concat(e!==h?"-".concat(e):"","-").concat(n))}),(0,i.jsx)(c,{ref:n,...l,className:r()(s,d,...x)})});l.displayName="Row",n.default=l},27305:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return i},useAppContext:function(){return a}});var s=t(57437),r=t(2265);let c=(0,r.createContext)({user:null,setUser:()=>{},isAuthenticated:!1}),a=()=>(0,r.useContext)(c);function i(e){let{children:n}=e,[t,a]=(0,r.useState)(null),i=(0,r.useCallback)(e=>{a(e),localStorage.setItem("user",JSON.stringify(e))},[a]);return(0,r.useEffect)(()=>{let e=localStorage.getItem("user");a(e?JSON.parse(e):null)},[a]),(0,s.jsx)(c.Provider,{value:{user:t,setUser:i,isAuthenticated:!!t},children:n})}},79096:function(e,n,t){"use strict";t.r(n),t.d(n,{ButtonDetail:function(){return C},CreateEmployee:function(){return v},CreateOrder:function(){return k},CreateTransaction:function(){return y},CreateTransshipment:function(){return N},EmployeeDelete:function(){return Z},SearchOrder:function(){return b},WorkPlateDelete:function(){return w}});var s=t(57437),r=t(73537),c=t(59853),a=t(66879),i=t(64561),l=t(47907),d=t(71399),o=t(26173),h=t(71709),u=t(6128),x=t(44295),j=t(86123),m=t(2265),g=t(27305),p=t(56512),f=t(9092);function b(){let e=(0,l.useRouter)(),n="";return(0,s.jsxs)(r.Z,{children:[(0,s.jsx)(c.Z.Control,{type:"text",id:"inputCode",name:"code",formMethod:"get",placeholder:"Nhập m\xe3 đơn h\xe0ng",className:"rounded-pill",onChange:e=>n=e.target.value}),(0,s.jsx)(a.Z,{className:"rounded-pill mx-2",onClick:()=>{""!==n.trim()&&(console.log("orderID",n),e.push("/customer/lookup-order?query=".concat(n)))},children:"\uD83D\uDD0D"})]})}function v(){let e=(0,l.useRouter)();return(0,s.jsxs)(a.Z,{onClick:()=>{e.push("/dashboard/employee/create")},className:"btnCreate",children:[(0,s.jsx)(o.zy7,{size:"2em"}),"Tạo nh\xe2n vi\xean"]})}function y(){let e=(0,l.useRouter)();return(0,s.jsx)(a.Z,{onClick:()=>{e.push("/dashboard/transaction/create")},className:"btnCreate",children:"Tạo điểm giao dịch"})}function N(){let e=(0,l.useRouter)();return(0,s.jsx)(a.Z,{onClick:()=>{e.push("/dashboard/transshipment/create")},className:"btnCreate",children:"Tạo điểm trung chuyển"})}function k(){let e=(0,l.useRouter)();return(0,s.jsxs)(a.Z,{onClick:()=>{e.push("/dashboard/ordered/create")},className:"btnCreate",children:[(0,s.jsx)(h.qS3,{size:"2em"}),"Tạo đơn h\xe0ng"]})}function C(e){let{url:n}=e,t=(0,l.useRouter)();return(0,s.jsx)("button",{onClick:()=>{t.push(n)},className:"btn btn-outline-warning",children:(0,s.jsx)(d.z5B,{})})}function Z(e){var n;let{id:t,refresh:r}=e,[c,l]=(0,m.useState)(!1),d=()=>l(!1),o=async()=>{try{await x.Z.deleteAccount(t).then(e=>{j.toast.success("X\xf3a nh\xe2n vi\xean th\xe0nh c\xf4ng"),r(),l(!1)})}catch(e){j.toast.error("X\xf3a nh\xe2n vi\xean thất bại")}},h=(null===(n=(0,g.useAppContext)().user)||void 0===n?void 0:n.id)===t;return(0,s.jsxs)(s.Fragment,{children:[h?(0,s.jsx)("button",{className:"btn btn-outline-danger ",disabled:!0,children:(0,s.jsx)(u.Psi,{})}):(0,s.jsx)("button",{className:"btn btn-outline-danger",onClick:()=>l(!0),children:(0,s.jsx)(u.Psi,{})}),(0,s.jsxs)(i.Z,{show:c,onHide:d,backdrop:"static",keyboard:!1,children:[(0,s.jsx)(i.Z.Header,{closeButton:!0,children:(0,s.jsx)(i.Z.Title,{children:"X\xe1c nhận x\xf3a nh\xe2n vi\xean"})}),(0,s.jsx)(i.Z.Body,{children:"Bạn c\xf3 chắc chắn muốn x\xf3a nh\xe2n vi\xean n\xe0y kh\xf4ng?"}),(0,s.jsxs)(i.Z.Footer,{children:[(0,s.jsx)(a.Z,{variant:"secondary",onClick:d,children:"Huỷ"}),(0,s.jsx)(a.Z,{variant:"primary",onClick:o,children:"X\xe1c nhận"})]})]})]})}function w(e){var n;let{id:t,refresh:r,type:c}=e,[l,d]=(0,m.useState)(!1),o=()=>d(!1),h=async()=>{try{await p.c.deleteWP(t).then(e=>{c===f.qw.Transaction?j.toast.success("X\xf3a điểm giao dịch th\xe0nh c\xf4ng"):j.toast.success("X\xf3a điểm trung chuyển th\xe0nh c\xf4ng"),r(),d(!1)})}catch(e){c===f.qw.Transaction?j.toast.error("X\xf3a điểm giao dịch thất bại"):j.toast.error("X\xf3a điểm trung chuyển thất bại")}},x=(null===(n=(0,g.useAppContext)().user)||void 0===n?void 0:n.id)===t;return(0,s.jsxs)(s.Fragment,{children:[x?(0,s.jsx)("button",{className:"btn btn-outline-danger ",disabled:!0,children:(0,s.jsx)(u.Psi,{})}):(0,s.jsx)("button",{className:"btn btn-outline-danger",onClick:()=>d(!0),children:(0,s.jsx)(u.Psi,{})}),(0,s.jsxs)(i.Z,{show:l,onHide:o,backdrop:"static",keyboard:!1,children:[(0,s.jsx)(i.Z.Header,{closeButton:!0,children:(0,s.jsx)(i.Z.Title,{children:c===f.qw.Transaction?"X\xe1c nhận xo\xe1 điểm giao dịch":"X\xe1c nhận xo\xe1 điểm trung chuyển"})}),(0,s.jsx)(i.Z.Body,{children:c===f.qw.Transaction?"Bạn c\xf3 chắc chắn muốn x\xf3a điểm giao dịch n\xe0y kh\xf4ng?":"Bạn c\xf3 chắc chắn muốn x\xf3a điểm trung chuyển n\xe0y kh\xf4ng?"}),(0,s.jsxs)(i.Z.Footer,{children:[(0,s.jsx)(a.Z,{variant:"secondary",onClick:o,children:"Huỷ"}),(0,s.jsx)(a.Z,{variant:"primary",onClick:h,children:"X\xe1c nhận"})]})]})]})}},47977:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return _}});var s=t(57437),r=t(79096),c=t(65453),a=t(47907),i=t(2265),l=t(24167),d=t(46701),o=t(42362),h=t(71709),u=t(22169),x=t(9092);t(95944);var j=t(66879),m=t(64561),g=t(55914),p=t(80590),f=t(59853),b=t(70997);function v(e){let{listOrder:n}=e;return(0,s.jsxs)("table",{className:"orderTable w-100",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{scope:"col",children:"ID"}),(0,s.jsx)("th",{scope:"col",children:"Địa chỉ gửi"}),(0,s.jsx)("th",{scope:"col",children:"Địa chỉ nhận"}),(0,s.jsx)("th",{scope:"col",children:"Ng\xe0y tạo"}),(0,s.jsx)("th",{scope:"col",children:"Loại"}),(0,s.jsx)("th",{scope:"col"})]})}),(0,s.jsx)("tbody",{className:"table-group-divider",children:null==n?void 0:n.map(e=>{var n;return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.id}),(0,s.jsxs)("td",{children:[e.sender_address.ward," - ",e.sender_address.district," - ",e.sender_address.province]}),(0,s.jsxs)("td",{children:[e.receiver_address.ward," - ",e.receiver_address.district," - ",e.receiver_address.province]}),(0,s.jsx)("td",{children:(0,u.Ft)(e.created_at)}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"badge rounded-pill bg-".concat("secondary"," p-2"),children:null===(n=e.type)||void 0===n?void 0:n.name})}),(0,s.jsx)("td",{className:"d-flex justify-content-center",children:(0,s.jsx)(r.ButtonDetail,{url:"/dashboard/ordered/".concat(e.id,"/detail")})})]},e.id)})}),0===n.length?(0,s.jsx)("caption",{children:"Kh\xf4ng c\xf3 đơn h\xe0ng n\xe0o"}):(0,s.jsxs)("caption",{children:["Tổng số đơn h\xe0ng: ",n.length]})]})}var y=t(86123),N=t(7434);function k(e){let{listOrder:n,mutate:t}=e,[r,c]=(0,i.useState)(!1),[a,l]=(0,i.useState)([]),[d,o]=(0,i.useState)(0),h=()=>c(!1),u=async()=>{if(0===n.length)y.toast.info("H\xe3y chọn \xedt nhất một đơn h\xe0ng để gửi");else{c(!0);let e=n.map(e=>e.id);console.log(e.join(",")),await N.T.getNextPosition(e.join(",")).then(e=>{if(e.payload.success){let n=e.payload.data,t=[];n.forEach(e=>{t.some(n=>n.id===e.id)||t.push(e)}),l(t)}})}},x=async()=>{try{if(0===d){y.toast.info("H\xe3y chọn địa điểm gửi h\xe0ng");return}console.log(d);let e=n.map(e=>({orderId:e.id,to_id:d}));await N.T.sendOrder({data:e}).then(e=>{e.payload.success&&(y.toast.success("Gửi h\xe0ng th\xe0nh c\xf4ng"),c(!1),t())})}catch(e){}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(j.Z,{onClick:u,className:"btnCreate",children:[(0,s.jsx)(b.OIQ,{size:"2em"}),"Gửi h\xe0ng"]}),(0,s.jsxs)(m.Z,{show:r,onHide:h,size:"xl",keyboard:!1,centered:!0,scrollable:!0,children:[(0,s.jsx)(m.Z.Header,{closeButton:!0,children:(0,s.jsx)(m.Z.Title,{children:"Gửi h\xe0ng"})}),(0,s.jsxs)(m.Z.Body,{children:[(0,s.jsx)(g.default,{className:"mt-2",children:(0,s.jsx)(p.default,{children:(0,s.jsxs)(f.Z.Group,{className:"col-sm-12 col-form-Form.Group",children:[(0,s.jsx)(f.Z.Label,{htmlFor:"workplate",children:(0,s.jsx)("h5",{children:"Chọn địa điểm gửi h\xe0ng"})}),(0,s.jsxs)("select",{id:"workplate",className:"form-select",defaultValue:"0",onChange:e=>{o(e.target.value)},children:[(0,s.jsx)("option",{disabled:!0,value:"0",children:"Chọn địa điểm gửi h\xe0ng"},0),null==a?void 0:a.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name," - ",e.address.province,", ",e.address.district,", ",e.address.ward]},e.id))]})]})})}),(0,s.jsx)(g.default,{className:"mt-5",children:(0,s.jsxs)(p.default,{children:[(0,s.jsx)("h5",{children:"Danh s\xe1ch h\xe0ng h\xf3a"}),(0,s.jsx)(v,{listOrder:n})]})})]}),(0,s.jsxs)(m.Z.Footer,{children:[(0,s.jsx)(j.Z,{variant:"secondary",onClick:h,children:"Huỷ"}),(0,s.jsx)(j.Z,{variant:"primary",onClick:x,children:"X\xe1c nhận"})]})]})]})}var C=t(6128);function Z(e){let{id:n,refresh:t}=e,[r,c]=(0,i.useState)(!1),a=()=>c(!1),l=async()=>{try{await N.T.deleteOrder(n).then(e=>{t(),c(!1)})}catch(e){y.toast.error("X\xf3a đơn h\xe0ng thất bại")}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{className:"btn btn-outline-danger",onClick:()=>c(!0),children:(0,s.jsx)(C.YK6,{})}),(0,s.jsxs)(m.Z,{show:r,onHide:a,backdrop:"static",keyboard:!1,children:[(0,s.jsx)(m.Z.Header,{closeButton:!0,children:(0,s.jsx)(m.Z.Title,{children:"X\xe1c nhận x\xf3a đơn h\xe0ng"})}),(0,s.jsx)(m.Z.Body,{children:"Bạn c\xf3 chắc chắn muốn x\xf3a đơn h\xe0ng n\xe0y kh\xf4ng?"}),(0,s.jsxs)(m.Z.Footer,{children:[(0,s.jsx)(j.Z,{variant:"secondary",onClick:a,children:"Huỷ"}),(0,s.jsx)(j.Z,{variant:"primary",onClick:l,children:"X\xe1c nhận"})]})]})]})}function w(e){let{listOrder:n,mutate:t}=e,r=async()=>{if(0===n.length){y.toast.info("H\xe3y chọn \xedt nhất một đơn h\xe0ng để nhận");return}try{let e=n.map(e=>({id:e.id,distance:12}));await N.T.receiveOrder({data:e}).then(e=>{e.payload.success&&(y.toast.success("Nhận h\xe0ng th\xe0nh c\xf4ng"),t())})}catch(e){}};return(0,s.jsxs)(j.Z,{onClick:r,className:"btnCreate",children:[(0,s.jsx)(b.OIQ,{size:"2em"}),"Nhận h\xe0ng"]})}var T=t(27305);function S(e){let{listOrder:n,mutate:t}=e,r=async()=>{if(0===n.length){y.toast.info("H\xe3y chọn \xedt nhất một đơn h\xe0ng để chuyển đi");return}try{let e=n.map(e=>e.id);await N.T.leaveOrder({data:e}).then(e=>{e.payload.success&&(y.toast.success("Chuyển đi th\xe0nh c\xf4ng"),t())})}catch(e){}};return(0,s.jsxs)(j.Z,{onClick:r,className:"btnCreate",children:[(0,s.jsx)(b.OIQ,{size:"2em"}),"Chuyển h\xe0ng"]})}function _(e){let{type:n}=e,t=(0,a.useSearchParams)(),[j,m]=(0,i.useState)(!1),[g,p]=(0,i.useState)("asc"),[f,b]=(0,i.useState)(!1),[v,y]=(0,i.useState)([]),{user:N}=(0,T.useAppContext)(),C=null==N?void 0:N.role.name,_=Number(t.get("page")||1),{data:D,error:H,isLoading:B,mutate:F}=(0,l.Aj)(n,_),O=(null==D?void 0:D.total)||1,X=Math.floor(O/d.LL)+(O%d.LL==0?0:1),P=e=>{"id"===e&&(j?p("asc"===g?"desc":"asc"):(m(!0),p("asc")))};if(H)return(0,s.jsx)("div",{children:"Failed to load"});if(B)return(0,s.jsx)("div",{children:"Loading..."});let L=(null==D?void 0:D.data)||[];j&&(L=[...L].sort((e,n)=>("asc"===g?1:-1)*(e.id-n.id)));let R=(e,n)=>{let{checked:t}=e.target;t?y([...v,n]):y(v.filter(e=>e!==n))};console.log(v.length);let z="",I=null;switch(n){case x.ZJ.Waiting:z="Danh s\xe1ch đơn h\xe0ng chờ gửi",I=(0,s.jsx)(k,{listOrder:v,mutate:F});break;case x.ZJ.Receiving:z="Danh s\xe1ch đơn h\xe0ng chờ nhận",I=(0,s.jsx)(w,{listOrder:v,mutate:F});break;case x.ZJ.Leave:z="Danh s\xe1ch đơn h\xe0ng chuyển đi",I=C===x.i4.Driver?(0,s.jsx)(S,{listOrder:v,mutate:F}):null;break;case x.ZJ.History:z="Lịch sử đơn hàng"}return(0,s.jsxs)("div",{className:"tableContainer",children:[(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col",children:(0,s.jsx)("h3",{children:z})}),(0,s.jsx)("div",{className:"col btnContainer",children:I})]}),(0,s.jsx)("div",{className:"row mt-2",children:(0,s.jsxs)("div",{className:"mt-2 flow-root",children:[(0,s.jsx)("div",{className:"inline-block min-w-full",children:(0,s.jsx)("div",{className:"rounded-lg bg-gray-50 md:pt-0 table-responsive",children:(0,s.jsxs)("table",{className:"orderTable w-100",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{scope:"col",children:(0,s.jsx)("input",{className:"form-check-input",type:"checkbox",checked:f,onChange:()=>{b(!f),f?y([]):y([...L])}})}),(0,s.jsxs)("th",{scope:"col",onClick:()=>P("id"),children:["ID ",j?"desc"===g?(0,s.jsx)(o.ZTc,{}):(0,s.jsx)(o.NWQ,{}):(0,s.jsx)(h.sj8,{})]}),(0,s.jsx)("th",{scope:"col",children:"Địa chỉ gửi"}),(0,s.jsx)("th",{scope:"col",children:"Địa chỉ nhận"}),(0,s.jsx)("th",{scope:"col",children:"Ng\xe0y tạo"}),(0,s.jsx)("th",{scope:"col",children:"Loại"}),(0,s.jsx)("th",{scope:"col",children:"Trạng th\xe1i"}),(0,s.jsx)("th",{scope:"col"})]})}),(0,s.jsx)("tbody",{className:"table-group-divider",children:null==L?void 0:L.map(e=>{var n;let t=e.notifications[e.notifications.length-1].status_id,c=x.iF[t].color;return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{scope:"row",children:(0,s.jsx)("input",{className:"form-check-input",type:"checkbox",checked:v.includes(e),onChange:n=>{R(n,e)}})}),(0,s.jsx)("td",{children:e.id}),(0,s.jsxs)("td",{children:[e.sender_address.ward," - ",e.sender_address.district," -"," ",e.sender_address.province]}),(0,s.jsxs)("td",{children:[e.receiver_address.ward," - ",e.receiver_address.district," -"," ",e.receiver_address.province]}),(0,s.jsx)("td",{children:(0,u.Ft)(e.created_at)}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"badge rounded-pill bg-".concat("secondary"," p-2"),children:null===(n=e.type)||void 0===n?void 0:n.name})}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"badge rounded-pill bg-".concat(c," p-2"),children:x.iF[t].name})}),(0,s.jsxs)("td",{className:"d-flex justify-content-center gap-1",children:[(0,s.jsx)(r.ButtonDetail,{url:"/dashboard/ordered/".concat(e.id,"/detail")}),(0,s.jsx)(Z,{id:e.id,refresh:F})]})]},e.id)})}),0===L.length?(0,s.jsx)("caption",{children:"Kh\xf4ng c\xf3 đơn h\xe0ng n\xe0o"}):(0,s.jsxs)("caption",{children:["Tổng số đơn h\xe0ng: ",O]})]})})}),(0,s.jsx)(c.Z,{totalPage:X})]})})]})}},65453:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var s=t(57437),r=t(22169),c=t(47907),a=t(8792);function i(e){let{totalPage:n}=e,t=(0,c.usePathname)(),i=(0,c.useSearchParams)(),l=e=>{let n=new URLSearchParams(i);return n.set("page",e.toString()),"".concat(t,"?").concat(n.toString())},d=Number(i.get("page"))||1,o=(0,r.jg)(d,n);return(0,s.jsxs)("ul",{className:"pagination d-flex justify-content-center mt-4",children:[d>1&&(0,s.jsx)("li",{className:"page-item",children:(0,s.jsx)(a.default,{className:"page-link",href:l(1),"aria-label":"Previous",style:{cursor:"pointer"},children:(0,s.jsx)("span",{"aria-hidden":"true",children:"\xab"})})}),o.map(e=>(0,s.jsx)("li",{className:"page-item",children:(0,s.jsx)(a.default,{className:e!=d?"page-link":"page-link active",href:l(e),children:e})},e)),d<n&&(0,s.jsx)("li",{className:"page-item",children:(0,s.jsx)(a.default,{href:l(d+1),className:"page-link","aria-label":"Next",style:{cursor:"pointer"},children:(0,s.jsx)("span",{"aria-hidden":"true",children:"\xbb"})})})]})}t(27034)},95944:function(){},27034:function(){}}]);